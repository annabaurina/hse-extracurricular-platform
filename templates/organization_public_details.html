{% extends "base.html" %}

{% block title %}{{ organization.name }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="card">
        <div class="card-body">
            <h1 class="card-title">{{ organization.name }}</h1>
            <p class="card-text">{{ organization.description }}</p>

            {% if current_user.is_authenticated and (current_user.role in ['admin', 'root_admin'] or current_user.id == organization.leader_id) %}
            <a href="{{ url_for('organization_details', org_id=organization.id) }}" class="btn btn-primary">
                Manage Organization (Admin View)
            </a>
            {% endif %}
        </div>
    </div>

    <div class="mt-4">
        <h2>Upcoming Events</h2>
        {% if events %}
        <div class="row">
            {% for event in events %}
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">{{ event.title }}</h5>
                        <p class="card-text">
                            <small class="text-muted">{{ event.date.strftime('%B %d, %Y at %H:%M') }}</small>
                        </p>
                        <p class="card-text">{{ event.description|truncate(200) }}</p>
                        <a href="{{ url_for('event_details', event_id=event.id) }}" class="btn btn-outline-primary">
                            View Details
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No upcoming events scheduled.</p>
        {% endif %}
    </div>

    <div class="mt-4">
        <h2>Available Positions</h2>
        {% if vacancies %}
        <div class="list-group">
            {% for vacancy in vacancies %}
            <div class="list-group-item">
                <h5>{{ vacancy.title }}</h5>
                <p>{{ vacancy.description|truncate(200) }}</p>
                <a href="{{ url_for('vacancy_details', vacancy_id=vacancy.id) }}" class="btn btn-outline-primary btn-sm">
                    View Details
                </a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>No current vacancies.</p>
        {% endif %}
    </div>
</div>
{% endblock %}